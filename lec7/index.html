
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <link rel="shortcut icon" href="../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.7.4">
    
    
      
        <title>7. Lambda and Functions - CS2030 Programming Methodology II</title>
      
    
    
      <script src="../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-769c285a91.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Gentium+Book+Basic">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
    
    
  </head>
  
  
  
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="../index.html" title="CS2030 Programming Methodology II" class="md-icon md-icon--home md-header-nav__button">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lectures
                </span>
              
            
            7. Lambda and Functions
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/nus-cs2030/1718-s1" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-icon md-icon--home md-nav__button"></i>
    
    CS2030 Programming Methodology II
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/nus-cs2030/1718-s1" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../index.html" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      General
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        General
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../about/index.html" title="About" class="md-nav__link">
      About
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../prereqs/index.html" title="Prerequisites" class="md-nav__link">
      Prerequisites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../policies/index.html" title="Policies" class="md-nav__link">
      Policies
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../schedule/index.html" title="Schedule" class="md-nav__link">
      Schedule
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../readings/index.html" title="Readings" class="md-nav__link">
      Readings
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../reviews/index.html" title="Review Qs" class="md-nav__link">
      Review Qs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../style/index.html" title="Coding Style" class="md-nav__link">
      Coding Style
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../midterm/index.html" title="Midterm" class="md-nav__link">
      Midterm
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" checked>
    
    <label class="md-nav__link" for="nav-8">
      Lectures
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Lectures
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../lec1/index.html" title="1. Abstraction & Encapsulation" class="md-nav__link">
      1. Abstraction & Encapsulation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lec2/index.html" title="2. Inheritance & Polymorphism" class="md-nav__link">
      2. Inheritance & Polymorphism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lec3/index.html" title="3. Inheritance, Continued" class="md-nav__link">
      3. Inheritance, Continued
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lec4/index.html" title="4. Memory, Exceptions, Generics" class="md-nav__link">
      4. Memory, Exceptions, Generics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lec5/index.html" title="5. Numbers, Strings, Collections" class="md-nav__link">
      5. Numbers, Strings, Collections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lec6/index.html" title="6. Nested Classes, Enums" class="md-nav__link">
      6. Nested Classes, Enums
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        7. Lambda and Functions
      </label>
    
    <a href="index.html" title="7. Lambda and Functions" class="md-nav__link md-nav__link--active">
      7. Lambda and Functions
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" title="Learning Objectives" class="md-nav__link">
    Learning Objectives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abstraction-principles-revisited" title="Abstraction Principles Revisited" class="md-nav__link">
    Abstraction Principles Revisited
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" title="Functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lambda-expression" title="Lambda Expression" class="md-nav__link">
    Lambda Expression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-reference" title="Method Reference" class="md-nav__link">
    Method Reference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composing-functions" title="Composing Functions" class="md-nav__link">
    Composing Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-functions" title="Other Functions" class="md-nav__link">
    Other Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#curried-functions" title="Curried Functions" class="md-nav__link">
    Curried Functions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lec8/index.html" title="8. More Lambda and Streams" class="md-nav__link">
      8. More Lambda and Streams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lec9/index.html" title="9. Functors, Monads, Collectors" class="md-nav__link">
      9. Functors, Monads, Collectors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lec10/index.html" title="10. Parallel Streams" class="md-nav__link">
      10. Parallel Streams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lec11/index.html" title="11. Asynchronous Programming" class="md-nav__link">
      11. Asynchronous Programming
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Exercises
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Exercises
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../exercise1/index.html" title="1. Circles & Points" class="md-nav__link">
      1. Circles & Points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../exercise2/index.html" title="2. Square & PaintedSquare" class="md-nav__link">
      2. Square & PaintedSquare
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../exercise3/index.html" title="3. PaintedSquare Revisited" class="md-nav__link">
      3. PaintedSquare Revisited
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../exercise4/index.html" title="4. Exceptions" class="md-nav__link">
      4. Exceptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../exercise5/index.html" title="5. Streams" class="md-nav__link">
      5. Streams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../exercise6/index.html" title="6. Functors, Collectors" class="md-nav__link">
      6. Functors, Collectors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../exercise7/index.html" title="7. Mock Exam" class="md-nav__link">
      7. Mock Exam
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Labs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Labs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../lab1/index.html" title="1. Question" class="md-nav__link">
      1. Question
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab01-comments/index.html" title="1. Comments" class="md-nav__link">
      1. Comments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab2/index.html" title="2. Question" class="md-nav__link">
      2. Question
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab02-comments/index.html" title="2. Comments" class="md-nav__link">
      2. Comments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab3/index.html" title="3. Question" class="md-nav__link">
      3. Question
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab4/index.html" title="4. Question" class="md-nav__link">
      4. Question
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab5/index.html" title="5. Question" class="md-nav__link">
      5. Question
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab6/index.html" title="6. Question" class="md-nav__link">
      6. Question
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab7/index.html" title="7. Question" class="md-nav__link">
      7. Question
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab8/index.html" title="8. Question" class="md-nav__link">
      8. Question
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab9/index.html" title="9. Question" class="md-nav__link">
      9. Question
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab10/index.html" title="10. Question" class="md-nav__link">
      10. Question
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab11/index.html" title="11. Question" class="md-nav__link">
      11. Question
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Software/Tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Software/Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../jdk/index.html" title="Java" class="md-nav__link">
      Java
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../javadoc/index.html" title="Javadoc" class="md-nav__link">
      Javadoc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../unix/index.html" title="UNIX" class="md-nav__link">
      UNIX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vim/index.html" title="Vim" class="md-nav__link">
      Vim
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" title="Learning Objectives" class="md-nav__link">
    Learning Objectives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abstraction-principles-revisited" title="Abstraction Principles Revisited" class="md-nav__link">
    Abstraction Principles Revisited
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" title="Functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lambda-expression" title="Lambda Expression" class="md-nav__link">
    Lambda Expression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-reference" title="Method Reference" class="md-nav__link">
    Method Reference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composing-functions" title="Composing Functions" class="md-nav__link">
    Composing Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-functions" title="Other Functions" class="md-nav__link">
    Other Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#curried-functions" title="Curried Functions" class="md-nav__link">
    Curried Functions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/nus-cs2030/1718-s1/edit/master/docs/lec7.md" title="Edit this page" class="md-icon md-content__icon">edit</a>
                
                
                <h1 id="lecture-7-functions">Lecture 7: Functions</h1>
<h2 id="learning-objectives">Learning Objectives</h2>
<p>After this lecture, students should be familiar with:</p>
<ul>
<li>the concept of functions as a side-effect free programming constructs and its relation to functions in mathematics.</li>
<li>the <code class="codehilite">Function</code> interface in Java 8, including apply and compose methods.</li>
<li>the syntax of method reference and lambda expression</li>
<li>how to write functions with multiple arguments using curried functions </li>
</ul>
<p>Java 8 introduces several new important new features, including lambda expressions and the stream APIs.  We will spend the next few lectures exploring these new features and how it allows us to write more succinct code and hopefully, less buggy code.  The stream APIs also makes it possible for us to parallelize our code for execution on multiple cores/processors with ease.</p>
<h2 id="abstraction-principles-revisited">Abstraction Principles Revisited</h2>
<p>Let's revisit the abstraction principles we first visited in Lecture 2.  It says that "Each significant piece of functionality in a program should be implemented in just one place in the source code. Where similar functions are carried out by distinct pieces of code, it is generally beneficial to combine them into one by abstracting out the varying parts."</p>
<p>We have seen this principles being applied in several ways.  </p>
<p>First, consider the methods to generate random inter-arrival time and random service time.  We can write them as methods below:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">double</span> <span class="nf">generateInterArrivalTime</span><span class="o">()</span> <span class="o">{</span>
  <span class="k">return</span> <span class="o">-</span><span class="n">Math</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">rng</span><span class="o">.</span><span class="na">nextDouble</span><span class="o">())/</span><span class="k">this</span><span class="o">.</span><span class="na">arrivalRate</span><span class="o">;</span>
<span class="o">}</span>

<span class="kt">double</span> <span class="nf">generateServiceTime</span><span class="o">()</span> <span class="o">{</span>
  <span class="k">return</span> <span class="o">-</span><span class="n">Math</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">rng</span><span class="o">.</span><span class="na">nextDouble</span><span class="o">())/</span><span class="k">this</span><span class="o">.</span><span class="na">serviceRate</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>

<p>You can see that the three methods above have similar implementation.  They all generate an exponentially distributed random number, with different rate.  One could apply the abstraction principle and write the code as follows:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">double</span> <span class="nf">randomExponentialValue</span><span class="o">(</span><span class="kt">double</span> <span class="n">rate</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="o">-</span><span class="n">Math</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">rng</span><span class="o">.</span><span class="na">nextDouble</span><span class="o">())/</span><span class="n">rate</span><span class="o">;</span>
<span class="o">}</span>

<span class="kt">double</span> <span class="nf">generateServiceTime</span><span class="o">()</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">randomExponentialValue</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">serviceRate</span><span class="o">);</span>
<span class="o">}</span>

<span class="kt">double</span> <span class="nf">generateInterArrivalTime</span><span class="o">()</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">randomExponentialValue</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">arrivalRate</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>

<p>Now, if you need a new exponentially distributed random number, say for inter-switching time or break time (see Lab 5), you can just write a method that calls <code class="codehilite">randomExponentialValue()</code> method with the appropriate rate.</p>
<p>Here, the varying parts that we abstracted out is the variables.  </p>
<p>Second, consider the <code class="codehilite">CircleQueue</code> and <code class="codehilite">PointQueue</code> examples from Lecture 4.  The two classes implements similar methods with similar logic.  The only difference is the type.  </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">class</span> <span class="nc">CircleQueue</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">Circle</span><span class="o">[]</span> <span class="n">circles</span><span class="o">;</span>
   <span class="o">:</span>
  <span class="kd">public</span> <span class="nf">CircleQueue</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{...}</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isFull</span><span class="o">()</span> <span class="o">{...}</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{...}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">enqueue</span><span class="o">(</span><span class="n">Circle</span> <span class="n">c</span><span class="o">)</span> <span class="o">{...}</span>
  <span class="kd">public</span> <span class="n">Circle</span> <span class="nf">dequeue</span><span class="o">()</span> <span class="o">{...}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">PointQueue</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">Point</span><span class="o">[]</span> <span class="n">points</span><span class="o">;</span>
   <span class="o">:</span>
  <span class="kd">public</span> <span class="nf">PointQueue</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{...}</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isFull</span><span class="o">()</span> <span class="o">{...}</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{...}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">enqueue</span><span class="o">(</span><span class="n">Point</span> <span class="n">p</span><span class="o">)</span> <span class="o">{...}</span>
  <span class="kd">public</span> <span class="n">Point</span> <span class="nf">dequeue</span><span class="o">()</span> <span class="o">{...}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>

<p>We then replace the two classes (and any future class that we might write to implement such queues) with a generic <code class="codehilite">Queue&lt;T&gt;</code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">class</span> <span class="nc">Queue</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">T</span><span class="o">[]</span> <span class="n">objects</span><span class="o">;</span>
   <span class="o">:</span>
  <span class="kd">public</span> <span class="n">Queue</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{...}</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isFull</span><span class="o">()</span> <span class="o">{...}</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{...}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">enqueue</span><span class="o">(</span><span class="n">T</span> <span class="n">o</span><span class="o">)</span> <span class="o">{...}</span>
  <span class="kd">public</span> <span class="n">T</span> <span class="nf">dequeue</span><span class="o">()</span> <span class="o">{...}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>

<p>Here, the varying parts that we abstracted out is the type of the elements.  </p>
<p>Third, consider how we tell <code class="codehilite">ArrayList.sort()</code> to sort the items in the array in Lecture 5.  By passing in <code class="codehilite">NameComparator</code>, we can tell <code class="codehilite">ArrayList</code> to sort in alphabetical order, either in ascending order or descending order, or by the length of the strings, or any other ways we like.   An alternative would be to have our own <code class="codehilite">StringList</code> class and implements methods <code class="codehilite">sortAlphabeticallyAscending()</code>, <code class="codehilite">sortAlphabeticallyDescending()</code>, <code class="codehilite">sortByLengthAscending()</code>, <code class="codehilite">sortByLengthDescending()</code>, etc.  But all of these methods would be implementing the same sorting algorithms, the only part that is different is the comparison method to determine the order of the elements.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">NameComparator</span> <span class="kd">implements</span> <span class="n">Comparator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span><span class="n">String</span> <span class="n">s1</span><span class="o">,</span> <span class="n">String</span> <span class="n">s2</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// return (s1.compareTo(s2));</span>
    <span class="c1">// return (s2.compareTo(s1));</span>
    <span class="k">return</span> <span class="o">(</span><span class="n">s2</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="n">s1</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">SortedList</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>

    <span class="n">names</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="s">&quot;Joffrey&quot;</span><span class="o">);</span>
    <span class="n">names</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">&quot;Cersei&quot;</span><span class="o">);</span>
    <span class="n">names</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s">&quot;Meryn&quot;</span><span class="o">);</span>
    <span class="n">names</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="s">&quot;Walder&quot;</span><span class="o">);</span>
      <span class="o">:</span>
      <span class="o">:</span>

    <span class="n">names</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="k">new</span> <span class="n">NameComparator</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>

<p>Here, the varying parts that we abstracted out is a snippet of the code, or functionality, of the methods.  This idea is much more powerful than just abstracting out how we compare and sort.  We will see how it can lead to a significantly different ways of writing code.</p>
<h2 id="functions">Functions</h2>
<p>While we have been using the terms functions and methods (and occasionally, procedure) interchangeably, we will now use the term function to refer to methods with specific properties.  </p>
<p>A function, in mathematics, refer to a mapping from a set of inputs (<em>domain</em>) <span>\(X\)</span> to a set of output values (<em>codomain</em>) <span>\(Y\)</span>.  We write <span>\(f: X \rightarrow Y\)</span>.  Every input in the domain must map to exactly one output but multiple inputs can map to the same output.  Not all values in the codomain needs to be mapped.  The set of elements in the codomain that is mapped is called the <em>image</em>.  </p>
<p>Functions in programming language is the same as functions in mathematics.  Given an input, the function computes and returns an output.  A <em>pure</em> function does nothing else -- it does not print to the screen, write to files, throw exceptions, change other variables, modify the values of the arguments.  We say that a pure function does not cause any <em>side effect</em>.  </p>
<p>Here is an example of a pure functions:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="nf">square</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">i</span> <span class="o">*</span> <span class="n">i</span><span class="o">;</span>
<span class="o">}</span>

<span class="kt">int</span> <span class="nf">add</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="kt">int</span> <span class="n">j</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>

<p>and some examples of non-pure functions:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="nf">div</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="kt">int</span> <span class="n">j</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">i</span> <span class="o">/</span> <span class="n">j</span><span class="o">;</span>  <span class="c1">// may throw an exception</span>
<span class="o">}</span>

<span class="kt">int</span> <span class="nf">incrCount</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">count</span> <span class="o">+</span> <span class="n">i</span><span class="o">;</span> <span class="c1">// assume that count is not final.</span>
                         <span class="c1">// this may give diff results for the same i.</span>
<span class="o">}</span>

<span class="kt">void</span> <span class="nf">incrCount</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">this</span><span class="o">.</span><span class="na">count</span> <span class="o">+=</span> <span class="n">i</span><span class="o">;</span> <span class="c1">// does not return a value</span>
                   <span class="c1">// and has side effects on count</span>
<span class="o">}</span>

<span class="kt">int</span> <span class="nf">addToList</span><span class="o">(</span><span class="n">ArrayList</span> <span class="n">queue</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">queue</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>  <span class="c1">// has side effects on queue</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></p>
<p>In fact, in OO paradigm, we commonly need to write methods that update the fields of an instance or compute values using the fields of an instance.  Such methods are not pure functions.
While the notion of pure functions might seems restrictive, recall how many times your program has a bug that is related to incorrect side effects or unintended side effects?  If we design and write our program with pure functions as much as possible, we could significantly reduce the number of bugs.</p>
<p>In mathematics, we say that a mapping is a <em>partial function</em> if not all elements in the domain are mapped.   A common programming error is to treat a partial function like a function -- for instance, the <code class="codehilite">div</code> method above is written as if it is defined for all int values, but it is not defined when <code class="codehilite">j</code> is 0.</p>
<p>Mathematically, a function takes in only one value and return one value (e.g., <code class="codehilite">square</code> above).  In programming, we often need to write functions that takes in more than one arguments (e.g., <code class="codehilite">add</code> above).  We will see how to reconcile this later.</p>
<p>Let's explore functions in Java 8 by looking at the <code class="codehilite">Function</code> interface, it is a generic interface with two type parameters, <code class="codehilite">Function&lt;T, R&gt;</code>, <code class="codehilite">T</code> is the type of the inpuT, <code class="codehilite">R</code> is the type of the Result.  It has one abstract method <code class="codehilite">R apply(T t)</code> that applies the function to a given argument.</p>
<p>Let's write a class that implements <code class="codehilite">Function</code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">class</span> <span class="nc">Square</span> <span class="kd">implements</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">apply</span><span class="o">(</span><span class="n">Integer</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>

<p>To use it, we can:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>int x = new Square().apply(4);
</pre></div>
</td></tr></table></p>
<p>So far, everything is as you have seen before, and is significantly more complex than just writing:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>int x = square(4);
</pre></div>
</td></tr></table>

<p>So, what is the use of this?  Consider now if we have a <code class="codehilite">List&lt;Integer&gt;</code> of integers, and we want to return another list where the elements is the square of the first list.  We can write a method:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">squareList</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">newList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">Integer</span> <span class="n">i</span><span class="o">:</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">newList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">square</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="n">newList</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
Creating a new list out of an existing list is actually a common pattern.  We might want to, say, create a list with the absolute values:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">negativeList</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">newList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">Integer</span> <span class="n">i</span><span class="o">:</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">newList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="n">newList</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>
This is actually a common pattern.  Applying the abstraction principles, we can generalize the method to:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">applyList</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">f</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">newList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">Integer</span> <span class="n">i</span><span class="o">:</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">newList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="n">newList</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></p>
<p>and call:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">applyList</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="k">new</span> <span class="n">Square</span><span class="o">());</span>
</pre></div>
</td></tr></table>
to return a list of squares.</p>
<p>If we do not want to create a new class just for this, we can, as before, use an anonymous class:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">applyList</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="k">new</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;()</span> <span class="o">{</span> 
  <span class="n">Integer</span> <span class="nf">apply</span><span class="o">(</span><span class="n">Integer</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">});</span>
</pre></div>
</td></tr></table></p>
<div class="admonition note">
<p class="admonition-title">Map</p>
<p>The <code class="codehilite">applyList</code> method above is most commonly refered to as <code class="codehilite">map</code>.</p>
</div>
<h3 id="lambda-expression">Lambda Expression</h3>
<p>The code is still pretty ugly, and there is much boiler plate code.  The key line is actually Line 3 above, <code class="codehilite">return x * x</code>.  Fortunately, Java 8 provides a clean way to write this:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">applyList</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="o">(</span><span class="n">Integer</span> <span class="n">x</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="o">;</span> <span class="o">});</span>
<span class="n">applyList</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="o">;</span> <span class="o">});</span>
<span class="n">applyList</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="o">);</span>
</pre></div>
</td></tr></table>

<p>The expressions above, including <code class="codehilite">x -&gt; x * x</code>, are <em>lambda expressions</em>.  You can recognize one by the use of <code class="codehilite">-&gt;</code>.   The left hand side lists the arguments (use <code class="codehilite">()</code> if there is no argument), while the right hand side is the computation.  We do not need the type in cases where Java can refer the type, or need the return statements and the curly brackets.</p>
<div class="admonition note">
<p class="admonition-title">lambda</p>
<p>Alonzo Church invented lambda calculus (<span>\(\lambda\)</span>-calculus) in 1936, before electronic computers, as a way to express computation.  In <span>\(\lambda\)</span>-calculus, all functions are anonymous.  The term lambda expression originated from there.</p>
</div>
<p>We can use lambda expressions just like any other values in Java.  We have seen above that we can pass a lambda expression to a method.  We can also assign lambda expression to a variable:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">square</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="o">;</span>
<span class="n">square</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="mi">4</span><span class="o">);</span>
</pre></div>
</td></tr></table></p>
<h3 id="method-reference">Method Reference</h3>
<p>We can use lambda expression to implement <code class="codehilite">applyList</code> with <code class="codehilite">abs()</code> method in <code class="codehilite">Math</code>.
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">applyList</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">x</span><span class="o">));</span>
</pre></div>
</td></tr></table></p>
<p>If we look carefully at <code class="codehilite">abs()</code>, however, it takes in an <code class="codehilite">int</code>, and returns an <code class="codehilite">int</code>.  So, it already fits the <code class="codehilite">Function&lt;Integer,Integer&gt;</code> interface (with autoboxing and unboxing).  As such, we can refer to the method with a method reference: <code class="codehilite">Math::abs</code>.  The code above can be simplified to:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">applyList</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="n">Math</span><span class="o">::</span><span class="n">abs</span><span class="o">);</span>
</pre></div>
</td></tr></table></p>
<p>Again, we can assign method reference and pass them around like any other objects.
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">Math</span><span class="o">::</span><span class="n">abs</span><span class="o">;</span>
<span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(-</span><span class="mi">4</span><span class="o">);</span>
</pre></div>
</td></tr></table></p>
<h3 id="composing-functions">Composing Functions</h3>
<p>The <code class="codehilite">Function</code> interface has two default methods:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">default</span> <span class="o">&lt;</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="nf">andThen</span><span class="o">(</span><span class="n">Function</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">R</span><span class="o">,?</span> <span class="kd">extends</span> <span class="n">V</span><span class="o">&gt;</span> <span class="n">after</span><span class="o">);</span>
<span class="k">default</span> <span class="o">&lt;</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">V</span><span class="o">,</span><span class="n">R</span><span class="o">&gt;</span> <span class="nf">compose</span><span class="o">(</span><span class="n">Function</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">V</span><span class="o">,?</span> <span class="kd">extends</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">before</span><span class="o">);</span>
</pre></div>
</td></tr></table></p>
<p>for composing two functions.  The term <em>compose</em> here is used in the mathematical sense (i.e., the <span>\(\cdot\)</span> operator in <span>\(f \cdot g\)</span>).</p>
<p>These two methods, <code class="codehilite">andThen</code> and <code class="codehilite">compose</code>, return another function, and they are generic methods, as they have a type parameter <code class="codehilite">&lt;V&gt;</code>.  Suppose we want to write a function that returns the square root of the absolute value of an int, we can write:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">double</span> <span class="nf">SquareRootAbs</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">x</span><span class="o">));</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></p>
<p>or, we can write either
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">abs</span> <span class="o">=</span> <span class="n">Math</span><span class="o">::</span><span class="n">abs</span><span class="o">;</span>
<span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Double</span><span class="o">&gt;</span> <span class="n">sqrt</span> <span class="o">=</span> <span class="n">Math</span><span class="o">::</span><span class="n">sqrt</span><span class="o">;</span>
<span class="n">abs</span><span class="o">.</span><span class="na">andThen</span><span class="o">(</span><span class="n">sqrt</span><span class="o">)</span>
</pre></div>
</td></tr></table></p>
<p>or 
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">sqrt</span><span class="o">.</span><span class="na">compose</span><span class="o">(</span><span class="n">abs</span><span class="o">)</span>
</pre></div>
</td></tr></table></p>
<p>But isn't writing the plain old method <code class="codehilite">SquareRootAbs()</code> clearer?  Why bother with <code class="codehilite">Function</code>?  The difference is that, <code class="codehilite">SquareRootAbs()</code> has to be written before we compile our code, and is fixed once we compile.  Using the <code class="codehilite">Function</code> interface, we can compose functions at <em>run time</em>, dynamically as needed!  Here is an example that you might be familiar with, from Lab 5:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">Function</span><span class="o">&lt;</span><span class="n">Customer</span><span class="o">,</span> <span class="n">Queue</span><span class="o">&gt;</span> <span class="n">findQueueToSwitchTo</span><span class="o">;</span>
<span class="k">if</span> <span class="o">(</span><span class="n">numOfQueue</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">findQueueToSwitchTo</span> <span class="o">=</span> <span class="n">findShortestQueue</span><span class="o">.</span><span class="na">andThen</span><span class="o">(</span><span class="n">checkIfFewerInFront</span><span class="o">);</span> 
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span> <span class="c1">// only one queue</span>
  <span class="n">findQueueToSwitchTo</span> <span class="o">=</span> <span class="n">Customer</span><span class="o">::</span><span class="n">getQueue</span><span class="o">;</span>  <span class="c1">// no need to do anything</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>

<p>So instead of relying on the logic that the shortest queue is the same as the only queue and there is always the same number of customer in front if the customer is already is in the shortest queue, we just redefine the function that finds the queue to switch to to return the only queue.</p>
<h3 id="other-functions">Other Functions</h3>
<p>Java 8 package <code class="codehilite">java.util.function</code> provides other useful interfaces, including:</p>
<ul>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Predicate.html"><code class="codehilite">Predicate&lt;T&gt;</code></a> with a <code class="codehilite">boolean test(T t)</code> method </li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Supplier.html"><code class="codehilite">Supplier&lt;T&gt;</code></a> with a <code class="codehilite">T get()</code> method</li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Consumer.html"><code class="codehilite">Consumer&lt;T&gt;</code></a> with a <code class="codehilite">void accept(T t)</code> method</li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/BiFunction.html"><code class="codehilite">BiFunction&lt;T,U,R&gt;</code></a> with a <code class="codehilite">R apply(T t, U u)</code> method</li>
</ul>
<p>Other variations that involves primitive types are also provided.</p>
<h3 id="curried-functions">Curried Functions</h3>
<p>Functions have an <em>arity</em>.  The <code class="codehilite">Function</code> interface is for unary functions that take in a single argument; the <code class="codehilite">BiFunction</code> inteface for binary functions, with two arguments.  But we can have functions that take more than two arguments.  We can, however, build functions that take in multiple arguments with only unary functions.   Let's look at this mathematically first.  Consider a binary function <span>\(f: (X, Y) \rightarrow Z\)</span>.  We can introduce <span>\(F\)</span> as a set of all functions <span>\(f': Y \rightarrow Z\)</span>, and rewrite <span>\(f\)</span> as <span>\(f: X \rightarrow F\)</span>, of <span>\(f: X \rightarrow Y \rightarrow Z\)</span>.</p>
<p>A trivial example for this is the <code class="codehilite">add</code> method that adds two <code class="codehilite">int</code> values. 
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="nf">add</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></p>
<p>This can be written as
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">add</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">y</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">);</span>
</pre></div>
</td></tr></table></p>
<p>To calcualte 1 + 1, we call
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">add</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">apply</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</pre></div>
</td></tr></table></p>
<p>Let's break it down a litte, <code class="codehilite">add</code> is a function that takes in an <code class="codehilite">Integer</code> object and returns a unary <code class="codehilite">Function</code> over <code class="codehilite">Integer</code>.  So <code class="codehilite">add.apply(1)</code> returns the function <code class="codehilite">y -&gt; 1 + y</code>.  We could assign this to a variable:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>Function&lt;Integer,Integer&gt; incr = add.apply(1);
</pre></div>
</td></tr></table></p>
<p>Here is the place where you need to change how you think: <code class="codehilite">add</code> is not a function that takes two arguments and return a value.  It is a <em>higher-order function</em> that takes in a single argument, and return another function.</p>
<p>The technique that translates a general <span>\(n\)</span>-ary function to a sequence of <span>\(n\)</span> unary functions is called <em>currying</em>.  After currying, we have a sequence of <em>curried</em> functions.  </p>
<div class="admonition note">
<p class="admonition-title">Curry</p>
<p>Currying is not related to food, but rather is named after computer scientist Haskell Curry, who popularized the technique.</p>
</div>
<p>Again, you might question why do we need this?  We can simply call <code class="codehilite">add(1, 1)</code>, instead of <code class="codehilite">add.apply(1).apply(1)</code>?  Well, the verbosity is the fault of Java instead of functional programming techniques.  Other languages like Haskell or Scala have much simpler syntax (e.g., <code class="codehilite">add 1 1</code> or <code class="codehilite">add(1)(1)</code>).  </p>
<p>If you get past the verbosity, there is another reason why currying is cool.  Consider <code class="codehilite">add(1, 1)</code> -- we have to have both arguments available at the same time to compute the function.  With currying, we no longer have to.  We can evaluate the different arguments at different time (as <code class="codehilite">incr</code> example above).  This feature is useful in cases where some arguments are not available until later.  We can <em>partially apply</em> a function first.  This is also useful if one of the arguments does not change often, or is expensive to compute.  We can save the partial results as a function and continue applying later.</p>
<p>Again, using Lab 5 as example, you may have a method <code class="codehilite">serve</code> that takes in a <code class="codehilite">Customer</code> c and a <code class="codehilite">Server</code> s in a <code class="codehilite">Simulation</code> class.  When a customer is created, you do not know who is the server is yet.  You can partially apply the method first with the customer.  When the customer is served, you apply it again with the server <code class="codehilite">s</code> as argument.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../lec6/index.html" title="6. Nested Classes, Enums" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                6. Nested Classes, Enums
              </span>
            </div>
          </a>
        
        
          <a href="../lec8/index.html" title="8. More Lambda and Streams" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                8. More Lambda and Streams
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright by Wei Tsang Ooi, Department of Computer Science, National University of Singapore 2017
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-c35428f87f.js"></script>
      
      
      <script>app.initialize({url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
    
  </body>
</html>